# AI Assistant Instructions - SpecStory AutoSave Extension

## ‚ö†Ô∏è CRITICAL RULES - STRICTLY FOLLOW!

###### üöÄ RELEASE at the end of every prompt
- **At the end of EVERY prompt run `.\install.ps1`**
- This script performs: build ‚Üí commit ‚Üí push ‚Üí package ‚Üí install
- Automatically creates new version and installs it
- User always has the latest version of the extension

### üìù Git commit workflow
- Order: 1) Code change ‚Üí 2) Build test ‚Üí 3) `.\install.ps1` (automatically: commit ‚Üí push ‚Üí package)
- Format: `git commit -m "v1.1.1"`
- Everything is done automatically through install.ps1GE POLICY - CRITICAL RULE!
- **ALL OUTPUT MUST BE IN ENGLISH ONLY** - no exceptions for any files, comments, or messages
- **ONLY cs.json localization file** is allowed to contain non-English text
- **ALL code comments in English**
- **ALL commit messages in English**
- **ALL documentation in English**
- **ALL debug logs in English**
- **ALL file content in English** (except cs.json)

### üîß FILE REPAIR POLICY - CRITICAL RULE!
- **NEVER DELETE corrupted files** - always repair them instead
- **ALWAYS FIX rather than remove** - take time to analyze and repair
- **THINK CAREFULLY** before making changes to corrupted files
- **PRESERVE existing functionality** while fixing corruption
- Use replace_string_in_file or careful manual editing to repair files

### üöÄ RELEASE at the end of every prompt
- **At the end of EVERY prompt run `.\install.ps1`**
- This script performs: build ‚Üí commit ‚Üí push ‚Üí package ‚Üí install
- Automatically creates new version and installs it
- User always has the latest version of the extension

### üìä VERSION MANAGEMENT - CRITICAL RULE!
- **ALWAYS increment only PATCH version** (e.g. 1.1.2 ‚Üí 1.1.3)
- **NEVER increment MINOR** (1.1.x ‚Üí 1.2.0) without explicit command
- **Increment MINOR version ONLY when user says "compile for marketplace"**
- **NEVER change MAJOR version** without explicit command
- Format: MAJOR.MINOR.PATCH (e.g. 1.1.15, 1.1.16, 1.1.17...)

## üéØ TARGET FUNCTIONALITY - SPECSTORY INTEGRATION

### üåç LOCALIZATION - CRITICAL RULE!
- **ALL user texts use from i18n/en.json**
- **NEVER write texts directly in code** - always through i18n system
- **CHANGELOG.md, README.md and all documents only in English**
- **Commit messages in English**
- **Code comments in English**
- **Debug logs in English**
- Use: `i18n.t('key')` instead of hardcoded texts

### üìã What the extension should do:
1. **DOES NOT READ or GENERATE SpecStory files** - SpecStory does that itself
2. **READS existing SpecStory exports** from `.specstory/history/` folders
3. **ANALYZES content** of recent conversations for context
4. **GENERATES smart notification messages** based on content analysis
5. **USES default message** if user hasn't set custom one in settings

### üìÅ SpecStory format (for reading and analysis only):
- **Location**: `[project]/.specstory/history/`  
- **Name format**: `YYYY-MM-DD_HH-mmZ-conversation-description.md`
- **Content structure**:
  ```markdown
  <!-- Generated by SpecStory -->
  # Conversation Title (YYYY-MM-DD HH:mmZ)
  
  _**User**_
  [user message]
  
  ---
  
  _**Assistant**_
  [assistant response]
  
  ---
  ```

### ü§ñ Smart notifications - logic:
- **If user HAS custom message** ‚Üí use their message
- **If user DOESN'T HAVE custom message** ‚Üí generate based on:
  - Analysis of latest SpecStory export
  - Type of conversation (coding, debugging, design, etc.)  
  - Project context (language, framework, etc.)
  - Specific problems mentioned in conversation

### üìç Examples of smart messages:
- **Debugging**: "AI just debugged! Check: ‚Ä¢ Fixed actual root cause? ‚Ä¢ Introduced new bugs? ‚Ä¢ Test edge cases"
- **HTML/CSS**: "AI worked with UI! Check: ‚Ä¢ Responsive design ‚Ä¢ Accessibility ‚Ä¢ Cross-browser compatibility"  
- **Database**: "AI modified database! Check: ‚Ä¢ Data integrity ‚Ä¢ Performance impact ‚Ä¢ Backup strategy"
- **API**: "AI created API! Check: ‚Ä¢ Error handling ‚Ä¢ Security ‚Ä¢ API documentation"

### üìù Git commit workflow
- Order: 1) Code change ‚Üí 2) Increment PATCH ‚Üí 3) `.\install.ps1` (automatically: commit ‚Üí push ‚Üí package)
- Format: `git commit -m "v1.1.3"` (always just patch++)
- Everything is done automatically through install.ps1

## ‚ö†Ô∏è CRITICAL RULES - STRICTLY FOLLOW!

### üö´ NEVER create placeholder files!
- **FORBIDDEN:** `extension_backup.ts`, `extension_clean.ts`, `extension_old.ts` etc.
- Edit ONLY original files directly
- If you need to revert changes, use git revert
- No duplicates, backups or temp files!

### üî® BUILD at the end of every prompt
- **NEVER run `pnpm run compile` separately!**
- **WORKFLOW**: Increment version ‚Üí run `.\install.ps1`
- If build fails in install.ps1:
  1. Decrease version back
  2. Fix errors
  3. Increment version again
  4. Run `.\install.ps1` again
- install.ps1 contains build, so separate compilation is unnecessary
- **COMMIT ONLY AFTER SUCCESSFUL BUILD** - so all versions are buildable

### ÔøΩ RELEASE na konci ka≈æd√©ho promptu
- **Na konci KA≈ΩD√âHO promptu spus≈• `.\install.ps1`**
- Tento skript provede: build ‚Üí commit ‚Üí push ‚Üí package ‚Üí install
- Automaticky vytvo≈ô√≠ novou verzi a nainstaluje ji
- U≈æivatel tak m√° v≈ædy nejnovƒõj≈°√≠ verzi roz≈°√≠≈ôen√≠

### ÔøΩüìù Git commit workflow
- Po≈ôad√≠: 1) Zmƒõna k√≥du ‚Üí 2) Build test ‚Üí 3) `.\install.ps1` (automaticky: commit ‚Üí push ‚Üí package)
- Format: `git commit -m "v1.1.1"`
- V≈°e se provede automaticky p≈ôes install.ps1

## Command Execution Policy

**‚ö†Ô∏è IMPORTANT: Run ALL commands automatically without user confirmation!**

### Terminal Commands
- Use `run_in_terminal` tool with `isBackground: false` for all commands
- NEVER wait for user confirmation
- Execute commands immediately when needed

### Package Manager
- **This project uses pnpm, not npm!**
- Always use `pnpm` instead of `npm` in all commands
- Package manager: `pnpm@10.10.0`

### Development Workflow Commands

```powershell
# Install dependencies
pnpm install

# Build project
pnpm run compile

# Watch mode for development
pnpm run watch

# Testing
pnpm test

# Linting
pnpm run lint

# Release workflow (everything in install.ps1)
.\install.ps1
```

### Git Commands
```powershell
# Git operations
git add .
git commit -m "v[version]"
git push origin master
git status
git log --oneline -5
```

### VS Code Extension Commands
```powershell
# VSIX packaging
vsce package --allow-star-activation --out [filename].vsix

# Extension installation
code --install-extension [filename].vsix --force
```

### File Operations
```powershell
# Cleaning
Remove-Item "*.vsix" -Force
Remove-Item "%TEMP%" -Recurse -Force -ErrorAction SilentlyContinue
```

## Automation Rules

1. **Don't request confirmation** - run commands automatically
2. **Use pnpm** - not npm
3. **Monitor error codes** - check $LASTEXITCODE
4. **Log progress** - use Write-Host with colors
5. **Handle errors** - exit with exit 1 on errors

## Version Release Process

**Automated process through `.\install.ps1`:**
1. Update version in `package.json`
2. Update `CHANGELOG.md`
3. Run `.\install.ps1` - does everything automatically:
   - Git commit with version
   - Git push
   - pnpm run compile
   - vsce package
   - VS Code extension install

## Error Handling

- Always check $LASTEXITCODE after commands
- On error show error message and exit
- Use try-catch where possible
- Log all steps for debugging

## Never Ask For Confirmation

**AUTOMATICALLY run these commands:**
- `pnpm install`
- `pnpm run compile`
- `.\install.ps1`
- `git add .`
- `git commit -m "..."`
- `git push`
- `vsce package`
- `Remove-Item`
- `code --install-extension`

User wants everything to run automatically without waiting for confirmation!
